# Repository Guidelines

This guide summarizes how to work effectively in this repository: where code lives, how to run the tools, and what standards to follow when contributing.

## Project Structure & Module Organization
- `mjepa/` contains the library code (core modules: `jepa.py`, `model.py`, `trainer.py`, `optimizer.py`, and `visualization/`).
- `tests/` contains pytest-based unit tests (see `tests/run_tests.py` for targeted runs).
- `config.yaml` holds runtime configuration defaults (non-secret).
- `mjepa/_version.py` is generated by hatch-vcs; do not edit manually.

## Build, Test, and Development Commands
- `make init` sets up the environment via `uv sync --all-groups`.
- `make style` formats code (autoflake, isort, autopep8, black).
- `make quality` runs formatting checks (`black --check` plus autopep8 checks).
- `make types` runs Pyright via npm.
- `make test` runs pytest with coverage.
- `make test-<pattern>` runs tests matching a pattern, e.g. `make test-model`.
- `make test-pdb-<pattern>` runs a pattern with PDB fallback.
- `make test-ci` runs CI tests and writes coverage XML.

## Coding Style & Naming Conventions
- Python 3.11â€“3.13 compatible; 4-space indentation.
- Black line length is 120; isort and autopep8 are enforced via `make style`.
- Use `snake_case` for modules/functions/variables and `CapWords` for classes.

## Testing Guidelines
- Tests use pytest + pytest-cov and live in `tests/` with `test_*.py` names.
- Use markers `ci_skip` or `cuda` when relevant.
- Prefer running `make test` locally; use `make test-ci` before CI-oriented changes.

## Commit & Pull Request Guidelines
- Commit subjects are short, imperative, and optional PR numbers in parentheses (e.g., `Fix autocast usage (#41)`).
- PRs should include a clear summary, testing commands run, and linked issues when applicable.
- Include screenshots only when behavior or outputs are visual.

## Configuration & Secrets
- Use `config.mk` for local secrets; keep it untracked (see `config.mk.example`).
- Keep secrets out of `config.yaml` and out of commits.
